\documentclass[11pt,a4paper]{article}

% Packages
\usepackage[utf8]{inputenc}
\usepackage{babel}
\usepackage{caption}
\usepackage{listings}
\usepackage{adjustbox}
\usepackage{enumitem}
\usepackage{boldline}
\usepackage{amssymb, amsmath}
\usepackage{amsthm}
\usepackage[margin=1in]{geometry}
\usepackage{xcolor}
\usepackage{soul}
\usepackage{upgreek}
\usepackage{pifont}


\usepackage{xcolor}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{corollary}{Corollary}[theorem]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem*{remark}{Remark}
\theoremstyle{definition}
\newtheorem{definition}{Definition}[section]
\newtheorem{proposition}{Proposition}[section]

% Meta
\title{}
\author{}
\date{}

% Custom
\providecommand{\abs}[1]{\lvert#1\rvert}
\setlength\parindent{0pt}
\definecolor{Light}{gray}{.90}
\newcommand\ddfrac[2]{\frac{\displaystyle #1}{\displaystyle #2}}
% Primera derivada parcial: \pder[f]{x}
\newcommand{\pder}[2][]{\frac{\partial#1}{\partial#2}}

\begin{document}
\maketitle
\section{Hamiltonian Cycle}

We will consider the problem of the Hamiltonian cycle of undirected graphs. Therefore an edge would have two sources instead of a source and a target as it is regarded on directed graphs. Prior to the reduction a little lemma will be proven.

\begin{lemma} Being $G=(V=\{ v_1,...,v_n\},E= \{e_1,...,e_m\})$ a graph. The set $ \{e_{i_1},...,e_{i_n}\}\subset E$ is a Hamiltonian cycle if, and only if, each vertex is the source to exactly two edges and the path  $ \{e_{i_1},...,e_{i_n}\}\subset E$ is connected.

\begin{proof}
	If each vertex is the source of an edge, then every vertex is accessible by an edge. Also, as every vertex has exactly two edges, each connected component of the graph would be a cycle. As the graph is connected there is only one of such components.\\
\end{proof}
	
\end{lemma}


In order to make the reduction we will represent with Boolean clauses these two condition:

\begin{itemize}
\item We will start defining the variables $e_1,...,e_n$ that will represent if the edge $e_i$ is choose for the path. Also, if a vertex $e_i$ has as sources $v_j,v_k$ then the variables $e_{i,v_j}$ and $e_{i,v_k}$ will be also defined. The first set of formulas to consider will be:

$$
	e_i \iff e_{i,v_j} \iff e_{i,v_k} \ \ \ \ \ \   \forall i \in 1,..,m, \forall j,k \in 1,...,n 
$$

Note than if $e_j$ does not have as source $v_j$ then $e_{j,v_j} \iff 0$. To ensure that each vertex is the source of exactly two edges we will define these clauses:

$$
	\bigwedge_{k=1}^m \left (\ \bigwedge_{i=1}^m \  \bigvee_{\substack{j=1\\  j\ne i}}^m e_{j,v_k} \right )
$$

In order two ensure that each vertex is source to at least two edges. Then to ensure that there would not be more than two:

$$
	\bigwedge_{h=1}^m \bigwedge_{\substack{i=1\\j=1\\k=1}}^n \neg e_{i,v_h} \vee \neg e_{j,v_h} \vee \neg e_{k,v_h} 
$$

\item To prove the connectivity we will use the connectivity matrix. Henceforth all matrix will be consider as $n\times n$-sized matrix. Given $A = (a_{i,j})$ such that $a_{i,j} = 1$ if, and only if, there is a edge between $v_i$ and $v_j$, otherwise $a_{i,j} = 0 $. Then consider $A^{k} = (a^*_{i,j})$, it happens that if $(a^*_{i,j})=1$ then there is a path of exactly length k. Then to check the connectivity we will define $A' = \sum_{i=0}^n A^i$ and defining the formula:\\
\[
(a'_{1,1}\wedge ... \wedge a'_{1,n}) \label{eq:einstein} \tag{1}
\]

Matrix product could be seen as a Boolean operation (for the purpose that we reach): Given $A = (a_{i,j})$, $B = (b_i,j)$ and $C=A\cdot B$ then 

$$
	c_{i,j} = (a_{i,1}\wedge b_{1,j}) \vee ... \vee (a_{i,n}\wedge b_{n,j})
$$

As we do not care about the exact value of the sum in $A'$ but only whether $a'_{i,j}$ is greater than 0 we could consider as sum the \emph{or} operation element-wise. This prove that the expression (1) is a formula, a bit laborious to do by hand but quite computable.

\end{itemize}
 It simple to follow that if we could satifie all the formulas then there would be a Hamiltonian cycle = $\{e_i\in E : e_i = 1\}$ where the second $e_i$ is the variable and the first one is the edge. If no such cycle exists the formulas will be unsatisfiables. Further work to do would consider the implementation and resolution of the problem, and trying to express every formula in CNF.
\end{document}
\end{document}